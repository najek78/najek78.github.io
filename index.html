<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Złote Heimerki 2026</title>

<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">

<style>

body {
  margin: 0;
  height: 100vh;
  overflow: hidden;
  color: #D3AF37;
  font-family: 'Cinzel', serif;

  background: linear-gradient(
    130deg,
    #020817,
    #0b1b3a,
    #0a0f2e,
    #1a093d,
    #020817
  );

  background-size: 400% 400%;
  animation: gradientMove 18s ease infinite;
}

body::before {
  content: "";
  position: fixed;
  inset: 0;
  pointer-events: none;

  background:
    radial-gradient(circle at 25% 30%, rgba(255,215,0,0.08), transparent 40%),
    radial-gradient(circle at 75% 70%, rgba(255,215,0,0.06), transparent 45%),
    radial-gradient(circle at 60% 20%, rgba(255,215,0,0.05), transparent 35%);
}

body::after {
  content: "";
  position: fixed;
  top: 35%;
  left: 50%;
  width: 900px;
  height: 900px;
  transform: translate(-50%, -50%);
  pointer-events: none;

  background: radial-gradient(circle,
    rgba(255,215,0,0.18),
    transparent 65%);
}

@keyframes gradientMove {
  0%   { background-position: 0% 50%; }
  50%  { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}


.logo {
  position: fixed;
  top: 30%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 560px;
  max-width: 90vw;
  filter:
    drop-shadow(0 0 25px rgba(255,215,0,0.6))
    drop-shadow(0 0 80px rgba(255,215,0,0.35));
  pointer-events: none;
}


.ui {
  position: fixed;
  top: 52%;
  left: 50%;
  transform: translateX(-50%);
  text-align: center;
  animation: fadeIn 1.2s ease forwards;
}

button {
  background: #D3AF37;
  color: #0b1b3a;
  border: none;
  padding: 14px 32px;
  font-size: 18px;
  border-radius: 14px;
  cursor: pointer;
  transition: 0.2s;
  margin: 10px;
  font-family: 'Cinzel', serif;
  font-weight: bold;
  letter-spacing: 1px;
}

button:hover {
  background: #ffd700;
  transform: scale(1.06);
}

.avatar {
  width: 110px;
  border-radius: 50%;
  margin: 20px 0;
  border: 4px solid #D3AF37;
  box-shadow: 0 0 18px rgba(255,215,0,0.6);
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translate(-50%, 20px);
  }
  to {
    opacity: 1;
    transform: translate(-50%, 0);
  }
}

</style>
</head>

<body>

<img src="logo.png" class="logo">

<div class="ui">

  <button id="login">Zaloguj przez Discord</button>

  <div id="user"></div>

</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
const { createClient } = supabase;

const supabaseClient = createClient(
  "https://vxbdvwjxudlxybnfsugn.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ4YmR2d2p4dWRseHlibmZzdWduIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzExODQyODEsImV4cCI6MjA4Njc2MDI4MX0.ZJG2DTwhcj8nG9eyUN1B3Zuf2IFIIZcq1rYpsYptrBk"
);

document.getElementById("login").onclick = async () => {
  await supabaseClient.auth.signInWithOAuth({
    provider: "discord"
  });
};

supabaseClient.auth.onAuthStateChange(async (event, session) => {
  if (session?.user) {
    showUser(session.user);
  }
});

async function loadUser() {
  const { data: { user } } = await supabaseClient.auth.getUser();
  if (user) showUser(user);
}

async function showUser(user) {
  document.getElementById("login").style.display = "none";

  const avatar = user.user_metadata.avatar_url;
  const name = user.user_metadata.full_name;

  document.getElementById("user").innerHTML = `
    <img src="${avatar}" class="avatar">
    <p>Zalogowano jako ${name}</p>
    <br>
    <button onclick="goToCategories()">Przejdź do kategorii</button>
    <br>
    <button onclick="logout()">Wyloguj</button>
  `;

  await supabaseClient.from("users").upsert({
    id: user.id,
    username: name,
    avatar_url: avatar
  });
}

async function logout() {
  await supabaseClient.auth.signOut();
  window.location.reload();
}

loadUser();

function goToCategories() {
  window.location.href = "categories.html";
}
</script>

</body>
</html>
